{% extends "base.html" %}
{% load static %}

{% block title %}ÙØ§ØªÙˆØ±Ø© {{ invoice.number }}{% endblock %}

{% block content %}
<div class="container py-4">

<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h3 mb-0">ÙØ§ØªÙˆØ±Ø© {{ invoice.number }}</h1>
  <div>
    <a href="{% url 'accounting:invoice_add_payment' number=invoice.number %}"
       class="btn btn-success me-2">
      + Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø©
    </a>
    <a href="{% url 'accounting:invoice_list' %}" class="btn btn-secondary">
      Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
    </a>
  </div>
</div>

  <div class="row mb-3">
    <div class="col-md-6">
      <h5>Ø§Ù„Ø¹Ù…ÙŠÙ„</h5>
      <p class="mb-1">{{ invoice.customer.name }}</p>
      {% if invoice.customer.company_name %}
      <p class="mb-1">{{ invoice.customer.company_name }}</p>
      {% endif %}
      {% if invoice.customer.phone %}
      <p class="mb-1">ğŸ“ {{ invoice.customer.phone }}</p>
      {% endif %}
      {% if invoice.customer.email %}
      <p class="mb-1">âœ‰ {{ invoice.customer.email }}</p>
      {% endif %}
    </div>
    <div class="col-md-6">
      <h5>ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</h5>
      <p class="mb-1">Ø§Ù„ØªØ§Ø±ÙŠØ®: {{ invoice.issued_at }}</p>
      <p class="mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚: {{ invoice.due_date|default:"-" }}</p>
      <p class="mb-1">Ø§Ù„Ø­Ø§Ù„Ø©: {{ invoice.get_status_display }}</p>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h5 class="card-title">Ø§Ù„Ù…Ø¨Ø§Ù„Øº</h5>
      <p class="mb-1">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: {{ invoice.total_amount }}</p>
      <p class="mb-1">Ø§Ù„Ù…Ø¯ÙÙˆØ¹: {{ invoice.paid_amount }}</p>
      <p class="mb-1">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: {{ invoice.balance }}</p>
    </div>
  </div>

  {% if invoice.description %}
  <div class="card mb-3">
    <div class="card-body">
      <h5 class="card-title">Ø§Ù„ÙˆØµÙ</h5>
      <p class="mb-0">{{ invoice.description|linebreaks }}</p>
    </div>
  </div>
  {% endif %}

  <div class="card">
    <div class="card-body">
      <h5 class="card-title">Ø§Ù„Ø¯ÙØ¹Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©</h5>
      <table class="table mb-0">
        <thead>
          <tr>
            <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
            <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
            <th>Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©</th>
            <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
          </tr>
        </thead>
        <tbody>
          {% for p in invoice.payments.all %}
          <tr>
            <td>{{ p.date }}</td>
            <td>{{ p.amount }}</td>
            <td>{{ p.get_method_display }}</td>
            <td>{{ p.notes }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4" class="text-muted text-center">
              Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙØ¹Ø§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

</div>
{% endblock %}
