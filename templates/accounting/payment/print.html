{% load i18n %}
<!doctype html>
<html lang="{{ LANGUAGE_CODE }}" dir="{% if LANGUAGE_CODE == 'ar' %}rtl{% else %}ltr{% endif %}">
<head>
  <meta charset="utf-8">
  <title>
    {% if payment.type == "receipt" %}
      {% blocktrans with number=payment.display_number %}سند قبض {{ number }}{% endblocktrans %}
    {% else %}
      {% blocktrans with number=payment.display_number %}سند صرف {{ number }}{% endblocktrans %}
    {% endif %}
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  {# Bootstrap فقط، RTL للعربي، LTR لغيره #}
  {% if LANGUAGE_CODE == 'ar' %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.rtl.min.css"
          rel="stylesheet"
          integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
          crossorigin="anonymous">
  {% else %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
          crossorigin="anonymous">
  {% endif %}
</head>
<body class="bg-light">

<div class="container my-4">
  <div class="card shadow-sm">
    <div class="card-body">

      {# ========= الهيدر ========= #}
      <div class="row mb-4">
        <div class="col-md-6">
          <h1 class="h4 fw-bold mb-1">Mazoon Aluminum</h1>
          <div class="text-muted small">
            {% trans "سلطنة عمان – ورشة/شركة الألمنيوم" %}<br>
            {% trans "هاتف:" %} +968-00000000<br>
            {% trans "بريد إلكتروني:" %} info@example.com
          </div>
        </div>
        <div class="col-md-6 text-md-end mt-3 mt-md-0">
          <h2 class="h5 fw-bold mb-2">
            {% if payment.type == "receipt" %}
              {% trans "سند قبض" %}
            {% else %}
              {% trans "سند صرف" %}
            {% endif %}
          </h2>
          <div class="small">
            <div class="mb-1">
              <span class="text-muted">{% trans "رقم السند:" %}</span>
              <span class="fw-semibold">{{ payment.display_number }}</span>
            </div>
            <div class="mb-1">
              <span class="text-muted">{% trans "التاريخ:" %}</span>
              <span class="fw-semibold">{{ payment.date|date:"Y-m-d" }}</span>
            </div>
            <div class="mb-1">
              <span class="text-muted">{% trans "القيمة:" %}</span>
              <span class="fw-semibold">{{ payment.amount }} {{ payment.currency }}</span>
            </div>
            <div class="mb-1">
              <span class="text-muted">{% trans "النوع:" %}</span>
              {% if payment.type == "receipt" %}
                <span class="badge bg-success-subtle text-success border border-success-subtle">
                  {% trans "سند قبض" %}
                </span>
              {% else %}
                <span class="badge bg-danger-subtle text-danger border border-danger-subtle">
                  {% trans "سند صرف" %}
                </span>
              {% endif %}
            </div>
          </div>
        </div>
      </div>

      {# ========= بيانات الطرف ========= #}
      <div class="mb-3">
        <h6 class="fw-bold mb-2">{% trans "بيانات الطرف" %}</h6>
        <div class="border rounded-3 p-3 bg-light">
          {% if payment.contact %}
            <div class="small mb-1">
              <span class="text-muted">{% trans "الاسم:" %}</span>
              <span class="fw-semibold">{{ payment.contact.name }}</span>
            </div>
            {% if payment.contact.company_name %}
              <div class="small mb-1">
                <span class="text-muted">{% trans "الشركة:" %}</span>
                <span class="fw-semibold">{{ payment.contact.company_name }}</span>
              </div>
            {% endif %}
            {% if payment.contact.tax_number %}
              <div class="small mb-1">
                <span class="text-muted">{% trans "الرقم الضريبي:" %}</span>
                <span class="fw-semibold">{{ payment.contact.tax_number }}</span>
              </div>
            {% endif %}
            {% if payment.contact.phone %}
              <div class="small mb-0">
                <span class="text-muted">{% trans "الهاتف:" %}</span>
                <span class="fw-semibold">{{ payment.contact.phone }}</span>
              </div>
            {% endif %}
          {% else %}
            <div class="small text-muted mb-0">
              {% trans "لم يتم ربط السند بأي عميل/مورد." %}
            </div>
          {% endif %}
        </div>
      </div>

      {# ========= تفاصيل السند ========= #}
      <div class="mb-3">
        <h6 class="fw-bold mb-2">{% trans "تفاصيل السند" %}</h6>
        <div class="table-responsive">
          <table class="table table-sm mb-0">
            <tbody class="small">
              <tr>
                <th class="w-25 text-muted fw-normal">{% trans "طريقة الدفع" %}</th>
                <td class="fw-semibold">
                  {% if payment.method %}
                    {{ payment.method.name }}
                  {% else %}
                    <span class="text-muted">—</span>
                  {% endif %}
                </td>
              </tr>
              <tr>
                <th class="text-muted fw-normal">{% trans "المرجع الخارجي" %}</th>
                <td class="fw-semibold">
                  {{ payment.reference|default:"—" }}
                </td>
              </tr>
              <tr>
                <th class="text-muted fw-normal">{% trans "المبلغ" %}</th>
                <td class="fw-semibold">
                  {{ payment.amount }} {{ payment.currency }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      {# ========= الملاحظات ========= #}
      {% if payment.notes %}
        <div class="mb-3">
          <h6 class="fw-bold mb-2">{% trans "الملاحظات" %}</h6>
          <div class="border rounded-3 p-3 bg-light small">
            {{ payment.notes|linebreaksbr }}
          </div>
        </div>
      {% endif %}

      <p class="text-center text-muted small d-print-none mt-4 mb-0">
        {% trans "يمكنك استخدام أمر الطباعة في المتصفح (Ctrl + P) ثم اختيار" %}
        <strong>Save as PDF</strong>.
      </p>

    </div>
  </div>
</div>

{# لو حاب تطبع مباشرة فعّل السطر التالي #}
{# <script>window.print();</script> #}

</body>
</html>
