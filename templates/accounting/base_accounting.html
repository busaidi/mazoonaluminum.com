{# templates/accounting/base_accounting.html #}
{% extends "base.html" %}
{% load i18n static %}

{% block content %}

<div class="container py-4">

  {# ======================= PAGE HEADER ======================= #}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h1 class="h3 fw-bold text-dark mb-1">{% trans "نظام المحاسبة" %}</h1>
      <p class="text-muted mb-0">
        {% trans "إدارة الفواتير، السندات، والقيود المالية." %}
      </p>
    </div>
  </div>

  {# ======================= NAVIGATION BAR (ثيم مزون) ======================= #}
  <div class="mb-3">
    <div class="bg-mazoon-card border rounded-3 shadow-sm px-2 py-2">
      <ul class="nav nav-pills flex-wrap small mazoon-nav gap-1 align-items-center">

        {# 1. الرئيسية / لوحة المحاسبة #}
        <li class="nav-item">
          <a class="nav-link px-3 py-1 {% if accounting_section == 'dashboard' %}active{% endif %}"
             href="{% url 'accounting:dashboard' %}">
            {% trans "الرئيسية" %}
          </a>
        </li>

        {# 2. المبيعات #}
        <li class="nav-item">
          <a class="nav-link px-3 py-1 {% if accounting_section == 'sales_invoices' %}active{% endif %}"
             href="{% url 'accounting:sales_invoice_list' %}">
            {% trans "المبيعات" %}
          </a>
        </li>

        {# 3. المشتريات #}
        <li class="nav-item">
          <a class="nav-link px-3 py-1 {% if accounting_section == 'purchase_invoices' %}active{% endif %}"
             href="{% url 'accounting:purchase_invoice_list' %}">
            {% trans "المشتريات" %}
          </a>
        </li>

        {# 4. السندات #}
        <li class="nav-item">
          <a class="nav-link px-3 py-1 {% if accounting_section == 'payments' %}active{% endif %}"
             href="{% url 'accounting:payment_list' %}">
            {% trans "السندات" %}
          </a>
        </li>

        {# 5. البنوك #}
        <li class="nav-item dropdown">
          <a class="nav-link px-3 py-1 dropdown-toggle {% if accounting_section == 'banking' %}active{% endif %}"
             data-bs-toggle="dropdown" href="#" role="button">
            {% trans "البنوك" %}
          </a>
          <ul class="dropdown-menu shadow-sm border-0">

            {# إدارة الحسابات البنكية #}
            <li>
              <h6 class="dropdown-header text-uppercase small">
                {% trans "إدارة الحسابات البنكية" %}
              </h6>
            </li>
            <li>
              <a class="dropdown-item"
                 href="{% url 'banking:bank_account_list' %}">
                {% trans "الحسابات البنكية" %}
              </a>
            </li>
            <li>
              <a class="dropdown-item"
                 href="{% url 'banking:bank_account_create' %}">
                {% trans "إضافة حساب بنكي جديد" %}
              </a>
            </li>

            <li><hr class="dropdown-divider"></li>

            {# كشوفات البنك #}
            <li>
              <h6 class="dropdown-header text-uppercase small">
                {% trans "كشوفات البنك" %}
              </h6>
            </li>
            <li>
              <a class="dropdown-item"
                 href="{% url 'banking:bank_statement_list' %}">
                {% trans "سجل كشوفات البنك" %}
              </a>
            </li>
            <li>
              <a class="dropdown-item"
                 href="{% url 'banking:bank_statement_upload' %}">
                {% trans "رفع كشف جديد" %}
              </a>
            </li>

            <li><hr class="dropdown-divider"></li>

            {# ملاحظة عن التسوية #}
            <li>
              <span class="dropdown-item-text text-muted small">
                {% trans "التسوية البنكية تتم من شاشة الحسابات البنكية (زر تسوية لكل حساب)." %}
              </span>
            </li>
          </ul>
        </li>

        {# 6. قيود اليومية #}
        <li class="nav-item">
          <a class="nav-link px-3 py-1 {% if accounting_section == 'entries' %}active{% endif %}"
             href="{% url 'accounting:journal_entry_list' %}">
            {% trans "قيود اليومية" %}
          </a>
        </li>

        <li class="border-start mx-2 d-none d-lg-block"></li>

        {# 7. التقارير #}
        <li class="nav-item dropdown">
          <a class="nav-link px-3 py-1 dropdown-toggle {% if accounting_section == 'reports' %}active{% endif %}"
             data-bs-toggle="dropdown" href="#" role="button">
            {% trans "التقارير" %}
          </a>
          <ul class="dropdown-menu shadow-sm border-0">
            <li>
              <a class="dropdown-item" href="{% url 'accounting:trial_balance' %}">
                {% trans "ميزان المراجعة" %}
              </a>
            </li>
            <li>
              <a class="dropdown-item" href="{% url 'accounting:account_ledger' %}">
                {% trans "كشف الحساب" %}
              </a>
            </li>
          </ul>
        </li>

        {# 8. الإعدادات (يمين في الشاشات الكبيرة) #}
        <li class="nav-item dropdown ms-lg-auto">
          <a class="nav-link px-3 py-1 dropdown-toggle {% if accounting_section == 'settings' %}active{% endif %}"
             data-bs-toggle="dropdown" href="#" role="button">
            {% trans "الإعدادات" %}
          </a>
          <ul class="dropdown-menu dropdown-menu-end shadow-sm border-0">
            <li>
              <h6 class="dropdown-header text-uppercase small">
                {% trans "البيانات الأساسية" %}
              </h6>
            </li>
            <li>
              <a class="dropdown-item" href="{% url 'accounting:fiscal_year_list' %}">
                {% trans "السنوات المالية" %}
              </a>
            </li>
            <li>
              <a class="dropdown-item" href="{% url 'accounting:account_list' %}">
                {% trans "دليل الحسابات" %}
              </a>
            </li>
            <li>
              <a class="dropdown-item" href="{% url 'accounting:journal_list' %}">
                {% trans "الدفاتر" %}
              </a>
            </li>
            <li>
              <a class="dropdown-item" href="{% url 'accounting:payment_method_list' %}">
                {% trans "طرق الدفع" %}
              </a>
            </li>

            <li><hr class="dropdown-divider"></li>
            <li>
              <h6 class="dropdown-header text-uppercase small">
                {% trans "التهيئة" %}
              </h6>
            </li>
            <li>
              <a class="dropdown-item" href="{% url 'accounting:ledger_settings' %}">
                {% trans "ربط الدفاتر" %}
              </a>
            </li>
            <li>
              <a class="dropdown-item" href="{% url 'accounting:accounting_settings' %}">
                {% trans "الضبط العام" %}
              </a>
            </li>
          </ul>
        </li>

      </ul>
    </div>
  </div>

  {# ======================= PAGE CONTENT ======================= #}
  <div class="fade-in">
    {% block accounting_content %}{% endblock %}
  </div>

</div>

{% endblock %}
