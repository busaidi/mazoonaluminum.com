{% extends "base.html" %}
{% load i18n %}

{# ========= SEO BLOCKS FOR BLOG LIST ========= #}

{# <title> tag #}
{% block meta_title %}
  {% if LANGUAGE_CODE == "ar" %}
    {% if current_category %}
      {{ current_category.name }} â€“ {% trans "Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©" %}
    {% elif current_tag %}
      {{ current_tag.name }} â€“ {% trans "Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©" %}
    {% else %}
      {% trans "Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©" %} â€“ Mazoon Aluminum
    {% endif %}
  {% else %}
    {% if current_category %}
      {{ current_category.name }} â€“ {% trans "Blog" %}
    {% elif current_tag %}
      {{ current_tag.name }} â€“ {% trans "Blog" %}
    {% else %}
      {% trans "Blog" %} â€“ Mazoon Aluminum
    {% endif %}
  {% endif %}
{% endblock %}

{# <meta name="description"> #}
{% block meta_description %}
  {% if current_category %}
    {% if LANGUAGE_CODE == "ar" %}
      {% blocktrans with name=current_category.name %}
        ØªØ¯ÙˆÙŠÙ†Ø§Øª Ù…ØµÙ†Ù‘ÙØ© ØªØ­Øª {{ name }} ÙÙŠ Ù…Ø¯ÙˆÙ†Ø© Ù…Ø²ÙˆÙ† Ø£Ù„Ù…Ù†ÙŠÙˆÙ….
      {% endblocktrans %}
    {% else %}
      {% blocktrans with name=current_category.name %}
        Posts under {{ name }} category in Mazoon Aluminum blog.
      {% endblocktrans %}
    {% endif %}
  {% elif current_tag %}
    {% if LANGUAGE_CODE == "ar" %}
      {% blocktrans with name=current_tag.name %}
        ØªØ¯ÙˆÙŠÙ†Ø§Øª Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„ÙˆØ³Ù… {{ name }} ÙÙŠ Ù…Ø¯ÙˆÙ†Ø© Ù…Ø²ÙˆÙ† Ø£Ù„Ù…Ù†ÙŠÙˆÙ….
      {% endblocktrans %}
    {% else %}
      {% blocktrans with name=current_tag.name %}
        Posts tagged with {{ name }} in Mazoon Aluminum blog.
      {% endblocktrans %}
    {% endif %}
  {% else %}
    {% if LANGUAGE_CODE == "ar" %}
      {% trans "Ø§ÙƒØªØ´Ù Ù…Ù‚Ø§Ù„Ø§Øª ÙˆØ£Ù†Ø´Ø·Ø© Ù…Ø²ÙˆÙ† Ø£Ù„Ù…Ù†ÙŠÙˆÙ… Ø¹Ù† Ø§Ù„Ø£Ù†Ø¸Ù…Ø©ØŒ Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ ÙˆØ§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„ØªÙ‚Ù†ÙŠØ©." %}
    {% else %}
      {% trans "Discover Mazoon Aluminum articles about systems, products, and technical news." %}
    {% endif %}
  {% endif %}
{% endblock %}

{# Open Graph #}
{% block og_title %}
  {% if LANGUAGE_CODE == "ar" %}
    {% if current_category %}
      {{ current_category.name }} â€“ {% trans "Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©" %}
    {% elif current_tag %}
      {{ current_tag.name }} â€“ {% trans "Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©" %}
    {% else %}
      {% trans "Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©" %} â€“ Mazoon Aluminum
    {% endif %}
  {% else %}
    {% if current_category %}
      {{ current_category.name }} â€“ {% trans "Blog" %}
    {% elif current_tag %}
      {{ current_tag.name }} â€“ {% trans "Blog" %}
    {% else %}
      {% trans "Blog" %} â€“ Mazoon Aluminum
    {% endif %}
  {% endif %}
{% endblock %}

{% block og_description %}
  {% if current_category %}
    {% if LANGUAGE_CODE == "ar" %}
      {% blocktrans with name=current_category.name %}
        ØªØ¯ÙˆÙŠÙ†Ø§Øª Ù…ØµÙ†Ù‘ÙØ© ØªØ­Øª {{ name }} ÙÙŠ Ù…Ø¯ÙˆÙ†Ø© Ù…Ø²ÙˆÙ† Ø£Ù„Ù…Ù†ÙŠÙˆÙ….
      {% endblocktrans %}
    {% else %}
      {% blocktrans with name=current_category.name %}
        Posts under {{ name }} category in Mazoon Aluminum blog.
      {% endblocktrans %}
    {% endif %}
  {% elif current_tag %}
    {% if LANGUAGE_CODE == "ar" %}
      {% blocktrans with name=current_tag.name %}
        ØªØ¯ÙˆÙŠÙ†Ø§Øª Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„ÙˆØ³Ù… {{ name }} ÙÙŠ Ù…Ø¯ÙˆÙ†Ø© Ù…Ø²ÙˆÙ† Ø£Ù„Ù…Ù†ÙŠÙˆÙ….
      {% endblocktrans %}
    {% else %}
      {% blocktrans with name=current_tag.name %}
        Posts tagged with {{ name }} in Mazoon Aluminum blog.
      {% endblocktrans %}
    {% endif %}
  {% else %}
    {% if LANGUAGE_CODE == "ar" %}
      {% trans "Ø§ÙƒØªØ´Ù Ù…Ù‚Ø§Ù„Ø§Øª ÙˆØ£Ù†Ø´Ø·Ø© Ù…Ø²ÙˆÙ† Ø£Ù„Ù…Ù†ÙŠÙˆÙ… Ø¹Ù† Ø§Ù„Ø£Ù†Ø¸Ù…Ø©ØŒ Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ ÙˆØ§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„ØªÙ‚Ù†ÙŠØ©." %}
    {% else %}
      {% trans "Discover Mazoon Aluminum articles about systems, products, and technical news." %}
    {% endif %}
  {% endif %}
{% endblock %}

{% block og_type %}website{% endblock %}
{% block og_url %}{{ request.build_absolute_uri }}{% endblock %}
{% block og_image %}{% endblock %}

{# Twitter #}
{% block twitter_title %}
  {% if LANGUAGE_CODE == "ar" %}
    {% if current_category %}
      {{ current_category.name }} â€“ {% trans "Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©" %}
    {% elif current_tag %}
      {{ current_tag.name }} â€“ {% trans "Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©" %}
    {% else %}
      {% trans "Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©" %} â€“ Mazoon Aluminum
    {% endif %}
  {% else %}
    {% if current_category %}
      {{ current_category.name }} â€“ {% trans "Blog" %}
    {% elif current_tag %}
      {{ current_tag.name }} â€“ {% trans "Blog" %}
    {% else %}
      {% trans "Blog" %} â€“ Mazoon Aluminum
    {% endif %}
  {% endif %}
{% endblock %}

{% block twitter_description %}
  {% if current_category %}
    {% if LANGUAGE_CODE == "ar" %}
      {% blocktrans with name=current_category.name %}
        ØªØ¯ÙˆÙŠÙ†Ø§Øª Ù…ØµÙ†Ù‘ÙØ© ØªØ­Øª {{ name }} ÙÙŠ Ù…Ø¯ÙˆÙ†Ø© Ù…Ø²ÙˆÙ† Ø£Ù„Ù…Ù†ÙŠÙˆÙ….
      {% endblocktrans %}
    {% else %}
      {% blocktrans with name=current_category.name %}
        Posts under {{ name }} category in Mazoon Aluminum blog.
      {% endblocktrans %}
    {% endif %}
  {% elif current_tag %}
    {% if LANGUAGE_CODE == "ar" %}
      {% blocktrans with name=current_tag.name %}
        ØªØ¯ÙˆÙŠÙ†Ø§Øª Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„ÙˆØ³Ù… {{ name }} ÙÙŠ Ù…Ø¯ÙˆÙ†Ø© Ù…Ø²ÙˆÙ† Ø£Ù„Ù…Ù†ÙŠÙˆÙ….
      {% endblocktrans %}
    {% else %}
      {% blocktrans with name=current_tag.name %}
        Posts tagged with {{ name }} in Mazoon Aluminum blog.
      {% endblocktrans %}
    {% endif %}
  {% else %}
    {% if LANGUAGE_CODE == "ar" %}
      {% trans "Ø§ÙƒØªØ´Ù Ù…Ù‚Ø§Ù„Ø§Øª ÙˆØ£Ù†Ø´Ø·Ø© Ù…Ø²ÙˆÙ† Ø£Ù„Ù…Ù†ÙŠÙˆÙ… Ø¹Ù† Ø§Ù„Ø£Ù†Ø¸Ù…Ø©ØŒ Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ ÙˆØ§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„ØªÙ‚Ù†ÙŠØ©." %}
    {% else %}
      {% trans "Discover Mazoon Aluminum articles about systems, products, and technical news." %}
    {% endif %}
  {% endif %}
{% endblock %}

{% block twitter_image %}{% endblock %}

{# Ø¹Ù†ÙˆØ§Ù† Ø¯Ø§Ø®Ù„ÙŠ Ù„Ùˆ Ø§Ø­ØªØ¬ØªÙ‡ #}
{% block title %}
  {% if LANGUAGE_CODE == "ar" %}
    {% trans "Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©" %}
  {% else %}
    {% trans "Blog" %}
  {% endif %}
{% endblock %}

{# ========= PAGE CONTENT ========= #}
{% block content %}
<div class="row g-4">

  {# ===== Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¯ÙˆÙŠÙ†Ø§Øª) ===== #}
  <div class="col-lg-8">
    <header class="mb-3">
      <h1 class="h3 fw-bold mb-1">
        {% if current_category %}
          {{ current_category.name }}
        {% elif current_tag %}
          {% trans "Ø§Ù„ÙˆØ³Ù…" %}: {{ current_tag.name }}
        {% else %}
          {% if LANGUAGE_CODE == "ar" %}
            {% trans "Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©" %}
          {% else %}
            {% trans "Blog" %}
          {% endif %}
        {% endif %}
      </h1>

      {% if q %}
        <p class="small text-muted mb-0">
          {% blocktrans with q=q %}
            Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† "{{ q }}"
          {% endblocktrans %}
        </p>
      {% endif %}
    </header>

    {% if posts %}
      <div class="vstack gap-3">
        {% for post in posts %}
          <article class="card blog-card border-0">
            <div class="card-body">
              <h2 class="h5 mb-1">
                <a href="{{ post.get_absolute_url }}" class="text-decoration-none text-dark">
                  {{ post.title }}
                </a>
              </h2>

              <div class="small text-muted mb-2 d-flex flex-wrap gap-2 align-items-center">
                <span>ğŸ“… {{ post.published_at|date:"Y-m-d" }}</span>

                {% if post.categories.all %}
                  <span>â€¢</span>
                  <span>
                    {% for c in post.categories.all %}
                      <span class="badge bg-light text-muted border">
                        {{ c.name }}
                      </span>
                    {% endfor %}
                  </span>
                {% endif %}
              </div>

              <p class="small mb-2 text-muted" style="line-height: 1.8;">
                {{ post.meta_description|default:post.body|truncatechars:220 }}
              </p>

              <a href="{{ post.get_absolute_url }}" class="btn btn-sm btn-outline-primary">
                {% trans "Ø§Ù‚Ø±Ø£ Ø§Ù„Ù…Ø²ÙŠØ¯" %}
              </a>
            </div>
          </article>
        {% endfor %}
      </div>

      {# Ø§Ù„ØªØ±Ù‚ÙŠÙ… #}
      {% if page_obj.has_other_pages %}
        <nav aria-label="Blog pagination" class="mt-3">
          <ul class="pagination pagination-sm mb-0">

            {% if page_obj.has_previous %}
              <li class="page-item">
                <a class="page-link"
                   href="?page={{ page_obj.previous_page_number }}{% if q %}&q={{ q }}{% endif %}">
                  Â«
                </a>
              </li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">Â«</span></li>
            {% endif %}

            {% for num in paginator.page_range %}
              {% if num == page_obj.number %}
                <li class="page-item active">
                  <span class="page-link">{{ num }}</span>
                </li>
              {% else %}
                <li class="page-item">
                  <a class="page-link"
                     href="?page={{ num }}{% if q %}&q={{ q }}{% endif %}">{{ num }}</a>
                </li>
              {% endif %}
            {% endfor %}

            {% if page_obj.has_next %}
              <li class="page-item">
                <a class="page-link"
                   href="?page={{ page_obj.next_page_number }}{% if q %}&q={{ q }}{% endif %}">
                  Â»
                </a>
              </li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">Â»</span></li>
            {% endif %}
          </ul>
        </nav>
      {% endif %}
    {% else %}
      <p class="text-muted mb-0">
        {% trans "Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¯ÙˆÙŠÙ†Ø§Øª Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹." %}
      </p>
    {% endif %}
  </div>

  {# ===== Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ ===== #}
  <div class="col-lg-4">
    <aside class="position-sticky" style="top: 88px;">

      {# Ø§Ù„Ø¨Ø­Ø« #}
      <div class="card border-0 mb-3">
        <div class="card-body">
          <h2 class="h6 mb-2 fw-bold">{% trans "Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©" %}</h2>
          <form method="get" class="d-flex gap-2">
            <input type="text"
                   name="q"
                   class="form-control form-control-sm"
                   value="{{ q }}"
                   placeholder="{% trans 'ÙƒÙ„Ù…Ø© Ø§Ù„Ø¨Ø­Ø«...' %}">
            <button class="btn btn-sm btn-primary" type="submit">
              {% trans "Ø¨Ø­Ø«" %}
            </button>
          </form>
        </div>
      </div>

      {# Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª #}
      {% if categories %}
        <div class="card border-0 mb-3">
          <div class="card-body">
            <h2 class="h6 mb-2 fw-bold">{% trans "Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª" %}</h2>
            <div class="vstack gap-1 small">
              <a href="{% url 'blog_list' %}"
                 class="text-decoration-none {% if not current_category and not current_tag %}fw-bold{% endif %}">
                {% trans "ÙƒÙ„ Ø§Ù„ØªØ¯ÙˆÙŠÙ†Ø§Øª" %}
              </a>
              {% for c in categories %}
                <a href="{% url 'blog_category' category_slug=c.slug %}"
                   class="text-decoration-none {% if current_category and current_category.slug == c.slug %}fw-bold{% endif %}">
                  {{ c.name }}
                </a>
              {% endfor %}
            </div>
          </div>
        </div>
      {% endif %}

      <div class="card border-0">
        <div class="card-body small text-muted">
          <strong class="d-block mb-1">{% trans "Ù…Ù„Ø§Ø­Ø¸Ø©" %}:</strong>
          <p class="mb-0">
            {% trans "Ù‡Ø°Ù‡ ØµÙØ­Ø© Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¯ÙˆÙŠÙ†Ø§ØªØŒ ÙˆÙŠÙ…ÙƒÙ† ØªØ·ÙˆÙŠØ±Ù‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ù„Ø¥Ø¶Ø§ÙØ© ÙˆØ³ÙˆÙ…ØŒ Ù…Ù‚Ø§Ù„Ø§Øª Ù…Ù…ÙŠØ²Ø©ØŒ Ø£Ùˆ Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø±." %}
          </p>
        </div>
      </div>

    </aside>
  </div>
</div>
{% endblock %}
