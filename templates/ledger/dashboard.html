{% extends "ledger/base_ledger.html" %}
{% load i18n %}

{% block ledger_content %}
<h2 class="h5 mb-3">{% trans "الملخص العام" %}</h2>

<div class="row g-3 mb-4">
  <div class="col-md-3 col-sm-6">
    <div class="card shadow-sm border-0">
      <div class="card-body py-3">
        <p class="text-muted small mb-1">{% trans "عدد الحسابات" %}</p>
        <h2 class="h4 mb-0">{{ accounts_count }}</h2>
      </div>
    </div>
  </div>

  <div class="col-md-3 col-sm-6">
    <div class="card shadow-sm border-0">
      <div class="card-body py-3">
        <p class="text-muted small mb-1">{% trans "إجمالي القيود" %}</p>
        <h2 class="h4 mb-0">{{ entries_count }}</h2>
      </div>
    </div>
  </div>

  <div class="col-md-3 col-sm-6">
    <div class="card shadow-sm border-0">
      <div class="card-body py-3">
        <p class="text-muted small mb-1">
          {% trans "قيود هذا الشهر" %}
          <span class="d-block small text-muted">
            {{ month_start }} → {{ today }}
          </span>
        </p>
        <h2 class="h4 mb-0">{{ month_entries_count }}</h2>
      </div>
    </div>
  </div>

  <div class="col-md-3 col-sm-6">
    <div class="card shadow-sm border-0">
      <div class="card-body py-3">
        <p class="text-muted small mb-1">{% trans "إجمالي الشهر" %}</p>
        <div class="d-flex justify-content-between small">
          <span>{% trans "مدين" %}:</span>
          <strong>{{ month_debit }}</strong>
        </div>
        <div class="d-flex justify-content-between small">
          <span>{% trans "دائن" %}:</span>
          <strong>{{ month_credit }}</strong>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row g-3 mb-4">
  <div class="col-md-4">
    <div class="card shadow-sm border-0 h-100">
      <div class="card-body">
        <h2 class="h6 mb-2">{% trans "إجراءات سريعة" %}</h2>
        <ul class="list-unstyled mb-0 small">
          <li class="mb-1">
            <a href="{% url 'ledger:account_create' %}">{% trans "إنشاء حساب جديد" %}</a>
          </li>
          <li class="mb-1">
            <a href="{% url 'ledger:journalentry_create' %}">{% trans "إنشاء قيد جديد" %}</a>
          </li>
          <li class="mb-1">
            <a href="{% url 'ledger:trial_balance' %}">{% trans "عرض ميزان المراجعة" %}</a>
          </li>
          <li class="mb-1">
            <a href="{% url 'ledger:account_ledger' %}">{% trans "عرض دفتر حساب" %}</a>
          </li>
          <li class="mb-1">
            <a href="{% url 'ledger:account_list' %}">{% trans "عرض دليل الحسابات" %}</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div class="col-md-8">
    <div class="card shadow-sm border-0 h-100">
      <div class="card-body">
        <h2 class="h6 mb-3">{% trans "أحدث القيود" %}</h2>

        {% if recent_entries %}
          <table class="table table-sm table-striped align-middle mb-0">
            <thead class="table-light">
            <tr>
              <th>{% trans "رقم" %}</th>
              <th>{% trans "التاريخ" %}</th>
              <th>{% trans "المرجع" %}</th>
              <th>{% trans "الوصف" %}</th>
              <th>{% trans "الإجمالي" %}</th>
              <th></th>
            </tr>
            </thead>
            <tbody>
            {% for e in recent_entries %}
              <tr>
                <td>JE-{{ e.id }}</td>
                <td>{{ e.date }}</td>
                <td>{{ e.reference }}</td>
                <td>{{ e.description|default:"-"|truncatechars:40 }}</td>
                <td>{{ e.total_debit }}</td>
                <td class="text-end">
                  <a href="{% url 'ledger:journalentry_detail' e.pk %}"
                     class="btn btn-outline-secondary btn-sm">
                    {% trans "عرض" %}
                  </a>
                </td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p class="text-muted small mb-0">
            {% trans "لا توجد قيود حتى الآن." %}
          </p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
